# 更新日志

本项目的所有显著更改都将记录在此文件中。

## [未发布] - 2026-02-19

### 新增功能 (Features)
- **全局并发安全**: 为财务、库存、采购和报销模块的关键操作实现了数据库事务支持，防止长时间运行下的数据竞争问题。
- **更新日志模块**: 新增了专属的系统更新记录页面 (`/changelog`)，支持手动维护的版本说明和自动抓取的 Git 提交历史。
- **Git集成**: 后端实现了 `git log` 解析功能，可在更新日志页面展示实时开发动态。

### 界面优化 (UI/UX)
- **侧边栏重构**: 将侧边栏改为现代化的深色主题，提升视觉层次感，并优化了菜单结构。
- **全局数据表格**: 重新设计了 `FinanceTable` 和 `PurchaseTable`：
    - 采用纯白背景与浅灰表头，视觉更清爽。
    - 增加了明显的行边框，提升数据可读性。
    - 实现了表头吸顶 (`Sticky Header`) 功能，便于长列表浏览。
- **Changelog 页面布局**: 采用双栏布局，左侧展示精选版本记录，右侧实时展示代码提交动态，且完美适配 Admin 布局。

### 问题修复 (Bug Fixes)
- **数据库死锁**: 修复了 `finance.ts` 中 `ensureFinanceSchema` 并发初始化导致的死锁问题 (`ER_LOCK_DEADLOCK`)，引入了单例模式确保 Schema 仅初始化一次。
- **样式与Lint修复**: 修正了 `globals.css` 中的未知规则警告，清理了未使用的变量与引用。

### 代码重构 (Refactoring)
- **数据库 Schema**: 优化了 `finance_records` 表结构，移除了冗余字段并增强了外键约束。
- **代码清理**: 移除了 `PurchaseTable` 等组件中未使用的 Props 和 imports。
